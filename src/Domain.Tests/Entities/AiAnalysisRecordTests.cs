using Domain.Entities.StatData;
using Domain.Entities.StatData.Salary;
using TestUtils.Fakes;
using Xunit;

namespace Domain.Tests.Entities;

public class AiAnalysisRecordTests
{
    [Fact]
    public void GetClearedReport_Cleared()
    {
        var target = new AiAnalysisRecord(
            new StatDataChangeSubscriptionFake(),
            "I am source",
            "```\nü§ñ –û—Ç—á–µ—Ç –æ –∑–∞—Ä–ø–ª–∞—Ç–µ –Ω–∞ –¥–∞—Ç—É 05.05.2025 –æ—Ç –°–µ—Ä–≤–∏—Å–∞ TechReviewü§ñ\n\n–î–∞—Ç–∞ –æ—Ç—á–µ—Ç–∞: 05.05.2025\n–í–∞–ª—é—Ç–∞: KZT\n\n<b>–û–±—â–∞—è —Å–≤–æ–¥–∫–∞:</b>\n–°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –≤—Å–µ–º —Ä–æ–ª—è–º: <b>984,314</b> KZT\n–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: <b>0.00%</b> ‚û°Ô∏è\n\n<b>–ê–Ω–∞–ª–∏–∑ –ø–æ —Ä–æ–ª—è–º:</b>\n\nüìä <b>Delivery Manager</b>\n–¢–µ–∫—É—â–∞—è —Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞: <b>1,320,000</b> KZT\n–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª–æ–π –Ω–µ–¥–µ–ª–∏: <b>0.00%</b> ‚û°Ô∏è\n–ó–∞—Ä–ø–ª–∞—Ç–∞ –æ—Å—Ç–∞–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –≤ —ç—Ç–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ. –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ—à–ª—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ü–∏–∏ –≤ —ç—Ç–æ–π —Ä–æ–ª–∏.\n–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ —Å –æ–±—â–µ–π —Å—Ä–µ–¥–Ω–µ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π –ø–æ –≤—Å–µ–º —Ä–æ–ª—è–º, –æ–Ω–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–µ.\n\nüìä <b>Product Manager</b>\n–¢–µ–∫—É—â–∞—è —Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞: <b>930,105.26</b> KZT\n–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª–æ–π –Ω–µ–¥–µ–ª–∏: <b>0.00%</b>\n\n–°–ª–µ–¥—É—é—â–∏–π –æ—Ç—á–µ—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω 12.05.2025. –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —É—Ç–æ—á–Ω–∏—Ç—å —Å–≤–µ–¥–µ–Ω–∏—è, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∞–Ω–∫–µ—Ç—É –ø–æ —Å—Å—ã–ª–∫–µ –Ω–∏–∂–µ.\n```",
            123.456,
            "gpt-4");

        var clearedReport = target.GetClearedReport();
        Assert.Equal(
            "ü§ñ –û—Ç—á–µ—Ç –æ –∑–∞—Ä–ø–ª–∞—Ç–µ –Ω–∞ –¥–∞—Ç—É 05.05.2025 –æ—Ç –°–µ—Ä–≤–∏—Å–∞ TechReviewü§ñ\n\n" +
            "–î–∞—Ç–∞ –æ—Ç—á–µ—Ç–∞: 05.05.2025\n–í–∞–ª—é—Ç–∞: KZT\n\n" +
            "<b>–û–±—â–∞—è —Å–≤–æ–¥–∫–∞:</b>\n" +
            "–°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –≤—Å–µ–º —Ä–æ–ª—è–º: <b>984,314</b> KZT\n" +
            "–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: <b>0.00%</b> ‚û°Ô∏è\n\n" +
            "<b>–ê–Ω–∞–ª–∏–∑ –ø–æ —Ä–æ–ª—è–º:</b>\n\nüìä <b>Delivery Manager</b>\n" +
            "–¢–µ–∫—É—â–∞—è —Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞: <b>1,320,000</b> KZT\n" +
            "–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª–æ–π –Ω–µ–¥–µ–ª–∏: <b>0.00%</b> ‚û°Ô∏è\n" +
            "–ó–∞—Ä–ø–ª–∞—Ç–∞ –æ—Å—Ç–∞–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –≤ —ç—Ç–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ. –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ—à–ª—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ü–∏–∏ –≤ —ç—Ç–æ–π —Ä–æ–ª–∏.\n" +
            "–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ —Å –æ–±—â–µ–π —Å—Ä–µ–¥–Ω–µ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π –ø–æ –≤—Å–µ–º —Ä–æ–ª—è–º, –æ–Ω–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–µ.\n\n" +
            "üìä <b>Product Manager</b>\n" +
            "–¢–µ–∫—É—â–∞—è —Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞: <b>930,105.26</b> KZT\n" +
            "–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª–æ–π –Ω–µ–¥–µ–ª–∏: <b>0.00%</b>\n\n" +
            "–°–ª–µ–¥—É—é—â–∏–π –æ—Ç—á–µ—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω 12.05.2025. –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —É—Ç–æ—á–Ω–∏—Ç—å —Å–≤–µ–¥–µ–Ω–∏—è, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∞–Ω–∫–µ—Ç—É –ø–æ —Å—Å—ã–ª–∫–µ –Ω–∏–∂–µ.", clearedReport);
    }
}